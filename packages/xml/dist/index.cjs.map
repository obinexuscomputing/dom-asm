{"version":3,"file":"index.cjs","sources":["../src/ast/DOMXMLOptimizer.ts","../src/generator/DOMXMLGenerator.ts","../src/parser/DOMXMLParser.ts","../src/tokenizer/XMLBaseTokenizer.ts","../src/tokenizer/DOMXMLTokenizer.ts","../src/validator/DOMXMLValidator.ts","../src/index.ts"],"sourcesContent":[null,null,null,null,null,null,null],"names":["DOMXMLOptimizer","optimize","ast","optimizedRoot","root","children","this","optimizeChildren","metadata","computeMetadata","optimized","filter","node","type","value","trim","some","child","Object","keys","attributes","length","map","i","splice","nodeCount","elementCount","textCount","commentCount","traverse","isRoot","forEach","DOMXMLGenerator","options","constructor","indent","newLine","xmlDeclaration","prettyPrint","generate","result","generateNode","depth","generateElement","generateText","generateComment","generateDoctype","Error","getIndent","name","entries","key","escapeAttribute","String","join","escapeText","repeat","text","replace","DOMXMLParser","tokens","position","setTokens","parse","stack","currentParent","token","elementNode","push","selfClosing","expectedTagName","location","line","column","pop","trimmedValue","unclosedTag","XMLBaseTokenizer","input","peek","offset","consume","char","readUntil","stop","startsWith","test","skipWhitespace","getCurrentLocation","DOMXMLTokenizer","tokenize","readComment","readDoctype","readEndTag","readStartTag","readText","tagName","readAttributes","undefined","quote","DOMXMLValidator","schema","strictMode","allowUnknownElements","customValidators","validate","errors","validateNode","validator","valid","path","currentPath","elements","elementSchema","code","message","nodePath","validateAttributes","validateChildren","required","attr","includes","elementChildren","tokenizer","parser","optimizer","generator","validateOnParse","optimizeAST","generatorOptions","validationOptions","validationResult","JSON","stringify"],"mappings":"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"}