{"version":3,"file":"index.cjs","sources":["../src/ast/DOMXMLOptimizer.ts","../src/generator/DOMXMLGenerator.ts","../src/parser/DOMXMLParser.ts","../src/tokenizer/XMLBaseTokenizer.ts","../src/tokenizer/DOMXMLTokenizer.ts","../src/validator/DOMXMLValidator.ts","../src/index.ts"],"sourcesContent":[null,null,null,null,null,null,null],"names":["DOMXMLOptimizer","optimize","ast","optimizedRoot","root","children","this","optimizeChildren","metadata","computeMetadata","optimized","filter","node","type","value","trim","some","child","Object","keys","attributes","length","map","i","splice","nodeCount","elementCount","textCount","commentCount","traverse","isRoot","forEach","DOMXMLGenerator","options","constructor","indent","newLine","xmlDeclaration","prettyPrint","generate","result","generateNode","depth","generateElement","generateText","generateComment","generateDoctype","Error","getIndent","name","entries","key","escapeAttribute","String","join","escapeText","repeat","text","replace","DOMXMLParser","tokens","position","setTokens","parse","stack","currentParent","token","elementNode","push","selfClosing","location","line","column","pop","unclosedTag","XMLBaseTokenizer","input","peek","offset","consume","char","readUntil","stop","startsWith","test","skipWhitespace","getCurrentLocation","DOMXMLTokenizer","tokenize","readComment","readDoctype","readEndTag","readStartTag","readText","tagName","readAttributes","undefined","quote","DOMXMLValidator","schema","strictMode","allowUnknownElements","customValidators","validate","errors","validateNode","validator","valid","path","currentPath","elements","elementSchema","code","message","nodePath","validateAttributes","validateChildren","required","attr","includes","elementChildren","tokenizer","parser","optimizer","generator","validateOnParse","optimizeAST","generatorOptions","validationOptions","validationResult","JSON","stringify"],"mappings":"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"}